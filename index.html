<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Auto-Privacy Screenshot Cleaner</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        /* [All your previous CSS here, unchanged for design consistency] */
        /* ---- Copy your previous style block verbatim ---- */
        /* ... (for brevity, not repeated here) ... */
    </style>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
</head>
<body>
    <div class="main-container">
        <div class="header">
            <h1><i class="bi bi-shield-check"></i> Privacy Screenshot Cleaner</h1>
            <p>Automatically detect and blur sensitive information in your screenshots</p>
        </div>

        <div class="upload-section" id="uploadSection">
            <div class="upload-icon">
                <i class="bi bi-cloud-upload"></i>
            </div>
            <h4>Drop your screenshot here or click to browse</h4>
            <p class="text-muted mb-3">Supports PNG, JPG, JPEG files up to 10MB</p>
            <input type="file" class="d-none" id="imageUpload" accept="image/png,image/jpeg,image/jpg" capture="environment">
            
            <div class="quick-actions">
                <button class="quick-action-btn" onclick="document.getElementById('imageUpload').click()">
                    <i class="bi bi-folder2-open"></i> Browse Files
                </button>
                <button class="quick-action-btn" id="pasteBtn">
                    <i class="bi bi-clipboard"></i> Paste from Clipboard
                </button>
                <button class="quick-action-btn" id="cameraBtn">
                    <i class="bi bi-camera"></i> Take Photo
                </button>
            </div>
        </div>

        <div class="feature-toggle">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="beforeAfterMode">
                <label class="form-check-label" for="beforeAfterMode">
                    <strong><i class="bi bi-eye"></i> Show Before/After Comparison</strong>
                </label>
            </div>
        </div>

        <div class="controls-grid">
            <div class="control-group">
                <h6><i class="bi bi-sliders"></i> Detection Settings</h6>
                <!-- [Detection checkboxes as before] -->
                <div class="form-check mb-2">
                    <input class="form-check-input" type="checkbox" id="detectEmails" checked>
                    <label class="form-check-label" for="detectEmails">üìß Email Addresses</label>
                </div>
                <div class="form-check mb-2">
                    <input class="form-check-input" type="checkbox" id="detectPhones" checked>
                    <label class="form-check-label" for="detectPhones">üì± Phone Numbers</label>
                </div>
                <div class="form-check mb-2">
                    <input class="form-check-input" type="checkbox" id="detectFaces" checked>
                    <label class="form-check-label" for="detectFaces">üë§ Faces</label>
                </div>
                <div class="form-check mb-2">
                    <input class="form-check-input" type="checkbox" id="detectAddresses">
                    <label class="form-check-label" for="detectAddresses">üè† Addresses</label>
                </div>
                <div class="form-check mb-2">
                    <input class="form-check-input" type="checkbox" id="detectCreditCards">
                    <label class="form-check-label" for="detectCreditCards">üí≥ Credit Cards</label>
                </div>
                <div class="form-check mb-2">
                    <input class="form-check-input" type="checkbox" id="detectSSN">
                    <label class="form-check-label" for="detectSSN">üÜî Social Security Numbers</label>
                </div>
            </div>

            <div class="control-group">
                <h6><i class="bi bi-person-check"></i> Personal Information</h6>
                <div class="form-check mb-2">
                    <input class="form-check-input" type="checkbox" id="blurNameCheck">
                    <label class="form-check-label" for="blurNameCheck">üè∑Ô∏è Blur My Name</label>
                </div>
                <input type="text" class="form-control mb-3" id="userNameInput" placeholder="Enter your name" style="display:none;">
                
                <div class="form-check mb-2">
                    <input class="form-check-input" type="checkbox" id="detectCustom">
                    <label class="form-check-label" for="detectCustom">üîç Custom Text</label>
                </div>
                <input type="text" class="form-control mb-3" id="customTextInput" placeholder="Enter custom text to blur" style="display:none;">
            </div>

            <div class="control-group">
                <h6><i class="bi bi-droplet"></i> Blur Settings</h6>
                <label class="form-label">
                    Blur Strength: <span id="blurValue">15</span>px
                    <span class="blur-preview" id="blurPreview">
                        <canvas id="blurSampleCanvas" width="60" height="30" style="vertical-align:middle"></canvas>
                    </span>
                </label>
                <input type="range" min="5" max="50" value="15" class="form-range mb-3" id="blurSlider">
                
                <label class="form-label">Blur Style:</label>
                <select class="form-select mb-2" id="blurStyle">
                    <option value="gaussian">Gaussian Blur</option>
                    <option value="pixelate">Pixelate</option>
                    <option value="blackout">Black Box</option>
                </select>
            </div>
        </div>

        <div class="canvas-container">
            <canvas id="canvas"></canvas>
            <div class="placeholder" id="placeholder">
                <div>
                    <i class="bi bi-image" style="font-size: 5rem; color: #cbd5e1;"></i>
                    <h4 class="mt-3">No image uploaded</h4>
                    <p>Upload a screenshot to get started with privacy protection</p>
                </div>
            </div>
            <div class="loading-overlay" id="loadingOverlay" style="display: none;">
                <svg class="progress-ring" viewBox="0 0 80 80">
                    <circle class="progress-ring-circle" cx="40" cy="40" r="36"></circle>
                    <circle class="progress-ring-progress" cx="40" cy="40" r="36" id="progressCircle"></circle>
                </svg>
                <h5 id="loadingText">Processing image...</h5>
                <p id="loadingSubtext">Please wait while we analyze your image</p>
            </div>
        </div>

        <div class="before-after-container" id="beforeAfterContainer" style="display: none;">
            <div class="before-after-item">
                <h6><i class="bi bi-eye"></i> Before (Original)</h6>
                <canvas id="beforeCanvas"></canvas>
            </div>
            <div class="before-after-item">
                <h6><i class="bi bi-eye-slash"></i> After (Protected)</h6>
                <canvas id="afterCanvas"></canvas>
            </div>
        </div>

        <div class="detection-stats" id="detectionStats" style="display: none;">
            <div class="stat-card" data-tooltip="Text-based sensitive information">
                <div class="stat-number" id="textDetections">0</div>
                <div class="stat-label">üìù Text Items Blurred</div>
            </div>
            <div class="stat-card" data-tooltip="Human faces detected">
                <div class="stat-number" id="faceDetections">0</div>
                <div class="stat-label">üë§ Faces Protected</div>
            </div>
            <div class="stat-card" data-tooltip="Total privacy protections applied">
                <div class="stat-number" id="totalDetections">0</div>
                <div class="stat-label">üõ°Ô∏è Total Protections</div>
            </div>
            <div class="stat-card" data-tooltip="Processing time">
                <div class="stat-number" id="processingTime">0</div>
                <div class="stat-label">‚è±Ô∏è Seconds</div>
            </div>
        </div>

        <div id="detectedItemsList" class="detected-items" style="display: none;">
            <h6><i class="bi bi-eye-slash"></i> Detected & Protected Items:</h6>
            <div id="detectedItemsContent"></div>
        </div>

        <div class="text-center">
            <button class="btn btn-custom me-3" id="downloadBtn" style="display:none;">
                <i class="bi bi-download"></i> Download Protected Image
            </button>
            <button class="btn btn-custom me-3" id="downloadOriginalBtn" style="display:none;">
                <i class="bi bi-file-earmark-image"></i> Download Original
            </button>
            <button class="btn btn-danger-custom me-3" id="undoBtn" style="display:none;">
                <i class="bi bi-arrow-counterclockwise"></i> Undo Last
            </button>
            <button class="btn btn-danger-custom" id="resetBtn" style="display:none;">
                <i class="bi bi-arrow-clockwise"></i> Reset All
            </button>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container"></div>

    <script src="main.js"></script>
</body>
</html>
